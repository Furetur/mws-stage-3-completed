"use strict";var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}!function(c){if("object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=c();else if("function"==typeof define&&define.amd)define([],c);else{var a;a="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,a.localforage=c()}}(function(){return function l(m,a,b){function d(e,f){if(!a[e]){if(!m[e]){var g="function"==typeof require&&require;if(!f&&g)return g(e,!0);if(c)return c(e,!0);var h=new Error("Cannot find module '"+e+"'");throw h.code="MODULE_NOT_FOUND",h}var i=a[e]={exports:{}};m[e][0].call(i.exports,function(b){var a=m[e][1][b];return d(a||b)},i,i.exports,l,m,a,b)}return a[e].exports}for(var c="function"==typeof require&&require,e=0;e<b.length;e++)d(b[e]);return d}({1:[function(c,m){(function(n){"use strict";function a(){j=!0;for(var d,e,f=p.length;f;){for(e=p,p=[],d=-1;++d<f;)e[d]();f=p.length}j=!1}function b(b){1!==p.push(b)||j||c()}var c,d=n.MutationObserver||n.WebKitMutationObserver;if(d){var f=0,o=new d(a),h=n.document.createTextNode("");o.observe(h,{characterData:!0}),c=function(){h.data=f=++f%2}}else if(n.setImmediate||void 0===n.MessageChannel)c="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var c=n.document.createElement("script");c.onreadystatechange=function(){a(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},n.document.documentElement.appendChild(c)}:function(){setTimeout(a,0)};else{var i=new n.MessageChannel;i.port1.onmessage=a,c=function(){i.port2.postMessage(0)}}var j,p=[];m.exports=b}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],2:[function(k,a,b){"use strict";function l(){}function d(b){if("function"!=typeof b)throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,b!==l&&h(this,b)}function e(d,a,b){this.promise=d,"function"==typeof a&&(this.onFulfilled=a,this.callFulfilled=this.otherCallFulfilled),"function"==typeof b&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function f(e,a,b){j(function(){var c;try{c=a(b)}catch(a){return m.reject(e,a)}c===e?m.reject(e,new TypeError("Cannot resolve promise with itself")):m.resolve(e,c)})}function g(c){var a=c&&c.then;if(c&&"object"==("undefined"==typeof c?"undefined":_typeof(c))&&"function"==typeof a)return function(){a.apply(c,arguments)}}function h(e,a){function b(a){d||(d=!0,m.reject(e,a))}function c(a){d||(d=!0,m.resolve(e,a))}var d=!1,h=i(function(){a(c,b)});"error"===h.status&&b(h.value)}function i(d,a){var b={};try{b.value=d(a),b.status="success"}catch(c){b.status="error",b.value=c}return b}var j=k(1),m={},n=["REJECTED"],o=["FULFILLED"],p=["PENDING"];a.exports=b=d,d.prototype.catch=function(b){return this.then(null,b)},d.prototype.then=function(d,a){if("function"!=typeof d&&this.state===o||"function"!=typeof a&&this.state===n)return this;var b=new this.constructor(l);return this.state===p?this.queue.push(new e(b,d,a)):f(b,this.state===o?d:a,this.outcome),b},e.prototype.callFulfilled=function(b){m.resolve(this.promise,b)},e.prototype.otherCallFulfilled=function(b){f(this.promise,this.onFulfilled,b)},e.prototype.callRejected=function(b){m.reject(this.promise,b)},e.prototype.otherCallRejected=function(b){f(this.promise,this.onRejected,b)},m.resolve=function(j,a){var b=i(g,a);if("error"===b.status)return m.reject(j,b.value);var c=b.value;if(c)h(j,c);else{j.state=o,j.outcome=a;for(var d=-1,k=j.queue.length;++d<k;)j.queue[d].callFulfilled(a)}return j},m.reject=function(e,a){e.state=n,e.outcome=a;for(var b=-1,f=e.queue.length;++b<f;)e.queue[b].callRejected(a);return e},b.resolve=function(b){return b instanceof this?b:m.resolve(new this(l),b)},b.reject=function(c){var a=new this(l);return m.reject(a,c)},b.all=function(d){function a(f,h){function a(b){n[h]=b,++g!==c||e||(e=!0,m.resolve(o,n))}k.resolve(f).then(a,function(b){e||(e=!0,m.reject(o,b))})}var k=this;if("[object Array]"!==Object.prototype.toString.call(d))return this.reject(new TypeError("must be an array"));var c=d.length,e=!1;if(!c)return this.resolve([]);for(var n=Array(c),g=0,b=-1,o=new this(l);++b<c;)a(d[b],b);return o},b.race=function(d){function a(c){b.resolve(c).then(function(b){e||(e=!0,m.resolve(j,b))},function(b){e||(e=!0,m.reject(j,b))})}var b=this;if("[object Array]"!==Object.prototype.toString.call(d))return this.reject(new TypeError("must be an array"));var c=d.length,e=!1;if(!c)return this.resolve([]);for(var i=-1,j=new this(l);++i<c;)a(d[i]);return j}},{1:1}],3:[function(c){(function(a){"use strict";"function"!=typeof a.Promise&&(a.Promise=c(2))}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{2:2}],4:[function(c,a){"use strict";function b(c,a){if(!(c instanceof a))throw new TypeError("Cannot call a class as a function")}function e(f,g){f=f||[],g=g||{};try{return new Blob(f,g)}catch(a){if("TypeError"!==a.name)throw a;for(var h="undefined"==typeof BlobBuilder?"undefined"==typeof MSBlobBuilder?"undefined"==typeof MozBlobBuilder?WebKitBlobBuilder:MozBlobBuilder:MSBlobBuilder:BlobBuilder,c=new h,d=0;d<f.length;d+=1)c.append(f[d]);return c.getBlob(g.type)}}function C(c,d){d&&c.then(function(b){d(null,b)},function(b){d(b)})}function D(d,a,b){"function"==typeof a&&d.then(a),"function"==typeof b&&d.catch(b)}function g(b){return"string"!=typeof b&&(console.warn(b+" used as a key, but it is not a string."),b=b+""),b}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function d(f){for(var a=f.length,b=new ArrayBuffer(a),c=new Uint8Array(b),d=0;d<a;d++)c[d]=f.charCodeAt(d);return b}function f(f){return new N(function(g){var a=f.transaction(O,T),b=e([""]);a.objectStore(O).put(b,"key"),a.onabort=function(b){b.preventDefault(),b.stopPropagation(),g(!1)},a.oncomplete=function(){var b=navigator.userAgent.match(/Chrome\/(\d+)/),a=navigator.userAgent.match(/Edge\//);g(a||!b||43<=parseInt(b[1],10))}}).catch(function(){return!1})}function i(b){return"boolean"==typeof P?N.resolve(P):f(b).then(function(b){return P=b})}function j(d){var a=Q[d.name],e={};e.promise=new N(function(c,a){e.resolve=c,e.reject=a}),a.deferredOperations.push(e),a.dbReady=a.dbReady?a.dbReady.then(function(){return e.promise}):e.promise}function k(d){var a=Q[d.name],b=a.deferredOperations.pop();if(b)return b.resolve(),b.promise}function l(e,a){var b=Q[e.name],c=b.deferredOperations.pop();if(c)return c.reject(a),c.promise}function m(g,a){return new N(function(b,c){if(Q[g.name]=Q[g.name]||w(),g.db){if(!a)return b(g.db);j(g),g.db.close()}var d=[g.name];a&&d.push(g.version);var e=M.open.apply(M,d);a&&(e.onupgradeneeded=function(a){var b=e.result;try{b.createObjectStore(g.storeName),1>=a.oldVersion&&b.createObjectStore(O)}catch(b){if("ConstraintError"!==b.name)throw b;console.warn("The database \""+g.name+"\" has been upgraded from version "+a.oldVersion+" to version "+a.newVersion+", but the storage \""+g.storeName+"\" already exists.")}}),e.onerror=function(b){b.preventDefault(),c(e.error)},e.onsuccess=function(){b(e.result),k(g)}})}function n(b){return m(b,!1)}function o(b){return m(b,!0)}function p(g,a){if(!g.db)return!0;var b=!g.db.objectStoreNames.contains(g.storeName),c=g.version<g.db.version,d=g.version>g.db.version;if(c&&(g.version!==a&&console.warn("The database \""+g.name+"\" can't be downgraded from version "+g.db.version+" to version "+g.version+"."),g.version=g.db.version),d||b){if(b){var e=g.db.version+1;e>g.version&&(g.version=e)}return!0}return!1}function q(e){return new N(function(a,b){var c=new FileReader;c.onerror=b,c.onloadend=function(b){var c=btoa(b.target.result||"");a({__local_forage_encoded_blob:!0,data:c,type:e.type})},c.readAsBinaryString(e)})}function r(b){return e([d(atob(b.data))],{type:b.type})}function s(b){return b&&b.__local_forage_encoded_blob}function t(d){var e=this,a=e._initReady().then(function(){var b=Q[e._dbInfo.name];if(b&&b.dbReady)return b.dbReady});return D(a,d,d),a}function u(f){j(f);for(var a,g=Q[f.name],b=g.forages,c=0;c<b.length;c++)a=b[c],a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null);return f.db=null,n(f).then(function(a){return f.db=a,p(f)?o(f):a}).then(function(a){f.db=g.db=a;for(var c=0;c<b.length;c++)b[c]._dbInfo.db=a}).catch(function(a){throw l(f,a),a})}function v(f,a,b,c){void 0===c&&(c=1);try{var g=f.db.transaction(f.storeName,a);b(null,g)}catch(d){if(0<c&&(!f.db||"InvalidStateError"===d.name||"NotFoundError"===d.name))return N.resolve().then(function(){if(!f.db||"NotFoundError"===d.name&&!f.db.objectStoreNames.contains(f.storeName)&&f.version<=f.db.version)return f.db&&(f.version=f.db.version+1),o(f)}).then(function(){return u(f).then(function(){v(f,a,b,c-1)})}).catch(b);b(d)}}function w(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function x(l){var a,m,n,o,p,q=.75*l.length,r=l.length,h=0;"="===l[l.length-1]&&(q--,"="===l[l.length-2]&&q--);var s=new ArrayBuffer(q),j=new Uint8Array(s);for(a=0;a<r;a+=4)m=V.indexOf(l[a]),n=V.indexOf(l[a+1]),o=V.indexOf(l[a+2]),p=V.indexOf(l[a+3]),j[h++]=m<<2|n>>4,j[h++]=(15&n)<<4|o>>2,j[h++]=(3&o)<<6|63&p;return s}function y(e){var a,f=new Uint8Array(e),c="";for(a=0;a<f.length;a+=3)c+=V[f[a]>>2],c+=V[(3&f[a])<<4|f[a+1]>>4],c+=V[(15&f[a+1])<<2|f[a+2]>>6],c+=V[63&f[a+2]];return 2==f.length%3?c=c.substring(0,c.length-1)+"=":1==f.length%3&&(c=c.substring(0,c.length-2)+"=="),c}function z(e,a,b,c){e.executeSql("CREATE TABLE IF NOT EXISTS "+a.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],b,c)}function A(g,i,b,c,d,e){g.executeSql(b,c,d,function(f,j){j.code===j.SYNTAX_ERR?f.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[name],function(f,a){a.rows.length?e(f,j):z(f,i,function(){f.executeSql(b,c,d,e)},e)},e):e(f,j)},e)}function B(j,k,i,c){var d=this;j=g(j);var e=new N(function(a,e){d.ready().then(function(){void 0===k&&(k=null);var f=k,g=d._dbInfo;g.serializer.serialize(k,function(h,b){b?e(b):g.db.transaction(function(b){A(b,g,"INSERT OR REPLACE INTO "+g.storeName+" (key, value) VALUES (?, ?)",[j,h],function(){a(f)},function(c,a){e(a)})},function(g){if(g.code===g.QUOTA_ERR){if(0<c)return void a(B.apply(d,[j,f,i,c-1]));e(g)}})})}).catch(e)});return C(e,i),e}function E(g){return new N(function(a,d){g.transaction(function(b){b.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(b,c){for(var d=[],e=0;e<c.rows.length;e++)d.push(c.rows.item(e).name);a({db:g,storeNames:d})},function(c,a){d(a)})},function(b){d(b)})})}function F(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(b){return!1}}function G(d,a){var b=d.name+"/";return d.storeName!==a.storeName&&(b+=d.storeName+"/"),b}function H(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(b){return!0}}function I(){return!H()||0<localStorage.length}function J(d,a){d[a]=function(){var b=arguments;return d.ready().then(function(){return d[a].apply(d,b)})}}function K(){for(var d,e=1;e<arguments.length;e++)if(d=arguments[e],d)for(var f in d)d.hasOwnProperty(f)&&(pa(d[f])?arguments[0][f]=d[f].slice():arguments[0][f]=d[f]);return arguments[0]}var L="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(b){return"undefined"==typeof b?"undefined":_typeof(b)}:function(b){return b&&"function"==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":"undefined"==typeof b?"undefined":_typeof(b)},M=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(b){}}();"undefined"==typeof Promise&&c(3);var N=Promise,O="local-forage-detect-blob-support",P=void 0,Q={},R=Object.prototype.toString,S="readonly",T="readwrite",U={_driver:"asyncStorage",_initStorage:function(k){function a(){return N.resolve()}var l=this,c={db:null};if(k)for(var b in k)c[b]=k[b];var d=Q[c.name];d||(d=w(),Q[c.name]=d),d.forages.push(l),l._initReady||(l._initReady=l.ready,l.ready=t);for(var e,m=[],g=0;g<d.forages.length;g++)e=d.forages[g],e!==l&&m.push(e._initReady().catch(a));var q=d.forages.slice(0);return N.all(m).then(function(){return c.db=d.db,n(c)}).then(function(b){return c.db=b,p(c,l._defaultConfig.version)?o(c):b}).then(function(f){c.db=d.db=f,l._dbInfo=c;for(var a,g=0;g<q.length;g++)a=q[g],a!==l&&(a._dbInfo.db=c.db,a._dbInfo.version=c.version)})},_support:function(){try{if(!M)return!1;var c="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),a="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!c||a)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(b){return!1}}(),iterate:function(f,a){var e=this,b=new N(function(a,b){e.ready().then(function(){v(e._dbInfo,S,function(c,d){if(c)return b(c);try{var j=d.objectStore(e._dbInfo.storeName),g=j.openCursor(),h=1;g.onsuccess=function(){var b=g.result;if(b){var c=b.value;s(c)&&(c=r(c));var i=f(c,b.key,h++);void 0===i?b.continue():a(i)}else a()},g.onerror=function(){b(g.error)}}catch(c){b(c)}})}).catch(b)});return C(b,a),b},getItem:function(e,f){var i=this;e=g(e);var b=new N(function(c,b){i.ready().then(function(){v(i._dbInfo,S,function(a,d){if(a)return b(a);try{var f=d.objectStore(i._dbInfo.storeName),g=f.get(e);g.onsuccess=function(){var b=g.result;void 0===b&&(b=null),s(b)&&(b=r(b)),c(b)},g.onerror=function(){b(g.error)}}catch(c){b(c)}})}).catch(b)});return C(b,f),b},setItem:function(f,h,b){var j=this;f=g(f);var c=new N(function(a,c){var b;j.ready().then(function(){return b=j._dbInfo,"[object Blob]"===R.call(h)?i(b.db).then(function(b){return b?h:q(h)}):h}).then(function(d){v(j._dbInfo,T,function(b,e){if(b)return c(b);try{var g=e.objectStore(j._dbInfo.storeName);null===d&&(d=void 0);var h=g.put(d,f);e.oncomplete=function(){void 0===d&&(d=null),a(d)},e.onabort=e.onerror=function(){var b=h.error?h.error:h.transaction.error;c(b)}}catch(b){c(b)}})}).catch(c)});return C(c,b),c},removeItem:function(e,f){var i=this;e=g(e);var b=new N(function(a,b){i.ready().then(function(){v(i._dbInfo,T,function(c,d){if(c)return b(c);try{var f=d.objectStore(i._dbInfo.storeName),g=f.delete(e);d.oncomplete=function(){a()},d.onerror=function(){b(g.error)},d.onabort=function(){var c=g.error?g.error:g.transaction.error;b(c)}}catch(c){b(c)}})}).catch(b)});return C(b,f),b},clear:function(d){var h=this,a=new N(function(b,i){h.ready().then(function(){v(h._dbInfo,T,function(a,c){if(a)return i(a);try{var d=c.objectStore(h._dbInfo.storeName),e=d.clear();c.oncomplete=function(){b()},c.onabort=c.onerror=function(){var b=e.error?e.error:e.transaction.error;i(b)}}catch(b){i(b)}})}).catch(i)});return C(a,d),a},length:function(d){var h=this,a=new N(function(b,i){h.ready().then(function(){v(h._dbInfo,S,function(a,c){if(a)return i(a);try{var d=c.objectStore(h._dbInfo.storeName),e=d.count();e.onsuccess=function(){b(e.result)},e.onerror=function(){i(e.error)}}catch(b){i(b)}})}).catch(i)});return C(a,d),a},key:function(e,a){var j=this,b=new N(function(a,b){return 0>e?void a(null):void j.ready().then(function(){v(j._dbInfo,S,function(c,d){if(c)return b(c);try{var f=d.objectStore(j._dbInfo.storeName),g=!1,k=f.openCursor();k.onsuccess=function(){var b=k.result;return b?void(0===e?a(b.key):g?a(b.key):(g=!0,b.advance(e))):void a(null)},k.onerror=function(){b(k.error)}}catch(c){b(c)}})}).catch(b)});return C(b,a),b},keys:function(d){var i=this,a=new N(function(d,b){i.ready().then(function(){v(i._dbInfo,S,function(a,c){if(a)return b(a);try{var e=c.objectStore(i._dbInfo.storeName),f=e.openCursor(),g=[];f.onsuccess=function(){var a=f.result;return a?void(g.push(a.key),a.continue()):void d(g)},f.onerror=function(){b(f.error)}}catch(c){b(c)}})}).catch(b)});return C(a,d),a},dropInstance:function(i,m){m=h.apply(this,arguments);var o=this.config();i="function"!=typeof i&&i||{},i.name||(i.name=i.name||o.name,i.storeName=i.storeName||o.storeName);var c,p=this;if(i.name){var e=i.name===o.name&&p._dbInfo.db,f=e?N.resolve(p._dbInfo.db):n(i).then(function(a){var b=Q[i.name],c=b.forages;b.db=a;for(var d=0;d<c.length;d++)c[d]._dbInfo.db=a;return a});c=i.storeName?f.then(function(a){if(a.objectStoreNames.contains(i.storeName)){var h=a.version+1;j(i);var m=Q[i.name],d=m.forages;a.close();for(var b,c=0;c<d.length;c++)b=d[c],b._dbInfo.db=null,b._dbInfo.version=h;return new N(function(c,b){var d=M.open(i.name,h);d.onerror=function(c){d.result.close(),b(c)},d.onupgradeneeded=function(){d.result.deleteObjectStore(i.storeName)},d.onsuccess=function(){var b=d.result;b.close(),c(b)}}).then(function(e){m.db=e;for(var a,f=0;f<d.length;f++)a=d[f],a._dbInfo.db=e,k(a._dbInfo)}).catch(function(a){throw(l(i,a)||N.resolve()).catch(function(){}),a})}}):f.then(function(a){j(i);var f=Q[i.name],c=f.forages;a.close();for(var b=0;b<c.length;b++)c[b]._dbInfo.db=null;return new N(function(e,f){var c=M.deleteDatabase(i.name);c.onerror=c.onblocked=function(d){var a=c.result;a&&a.close(),f(d)},c.onsuccess=function(){var b=c.result;b&&b.close(),e(b)}}).then(function(d){f.db=d;for(var a=0;a<c.length;a++)k(c[a]._dbInfo)}).catch(function(a){throw(l(i,a)||N.resolve()).catch(function(){}),a})})}else c=N.reject("Invalid arguments");return C(c,m),c}},V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",W=/^~~local_forage_type~([^~]+)~/,X="__lfsc__:",Y="__lfsc__:".length,Z="arbf",$="blob",_="si08",aa="ui08",ba="uic8",ca="si16",da="si32",ea="ur16",fa="ui32",ga="fl32",ha="fl64",ia=9+"arbf".length,ja=Object.prototype.toString,ka={serialize:function(g,a){var b="";if(g&&(b=ja.call(g)),g&&("[object ArrayBuffer]"===b||g.buffer&&"[object ArrayBuffer]"===ja.call(g.buffer))){var h,i=X;g instanceof ArrayBuffer?(h=g,i+=Z):(h=g.buffer,"[object Int8Array]"===b?i+=_:"[object Uint8Array]"===b?i+=aa:"[object Uint8ClampedArray]"===b?i+=ba:"[object Int16Array]"===b?i+=ca:"[object Uint16Array]"===b?i+=ea:"[object Int32Array]"===b?i+=da:"[object Uint32Array]"===b?i+=fa:"[object Float32Array]"===b?i+=ga:"[object Float64Array]"===b?i+=ha:a(new Error("Failed to get type for BinaryArray"))),a(i+y(h))}else if("[object Blob]"===b){var j=new FileReader;j.onload=function(){var b="~~local_forage_type~"+g.type+"~"+y(this.result);a(X+$+b)},j.readAsArrayBuffer(g)}else try{a(JSON.stringify(g))}catch(b){console.error("Couldn't convert value into a JSON string: ",g),a(null,b)}},deserialize:function(g){if(g.substring(0,Y)!==X)return JSON.parse(g);var a,h=g.substring(ia),i=g.substring(Y,ia);if(i===$&&W.test(h)){var d=h.match(W);a=d[1],h=h.substring(d[0].length)}var j=x(h);switch(i){case Z:return j;case $:return e([j],{type:a});case _:return new Int8Array(j);case aa:return new Uint8Array(j);case ba:return new Uint8ClampedArray(j);case ca:return new Int16Array(j);case ea:return new Uint16Array(j);case da:return new Int32Array(j);case fa:return new Uint32Array(j);case ga:return new Float32Array(j);case ha:return new Float64Array(j);default:throw new Error("Unkown type: "+i);}},stringToBuffer:x,bufferToString:y},la={_driver:"webSQLStorage",_initStorage:function(f){var g=this,b={db:null};if(f)for(var a in f)b[a]="string"==typeof f[a]?f[a]:f[a].toString();var c=new N(function(c,e){try{b.db=openDatabase(b.name,b.version+"",b.description,b.size)}catch(b){return e(b)}b.db.transaction(function(a){z(a,b,function(){g._dbInfo=b,c()},function(c,a){e(a)})},e)});return b.serializer=ka,c},_support:function(){return"function"==typeof openDatabase}(),iterate:function(g,a){var f=this,b=new N(function(a,c){f.ready().then(function(){var b=f._dbInfo;b.db.transaction(function(d){A(d,b,"SELECT * FROM "+b.storeName,[],function(e,c){for(var d=c.rows,f=d.length,k=0;k<f;k++){var l=d.item(k),i=l.value;if(i&&(i=b.serializer.deserialize(i)),void 0!==(i=g(i,l.key,k+1)))return void a(i)}a()},function(d,a){c(a)})})}).catch(c)});return C(b,a),b},getItem:function(f,e){var h=this;f=g(f);var b=new N(function(g,c){h.ready().then(function(){var b=h._dbInfo;b.db.transaction(function(a){A(a,b,"SELECT * FROM "+b.storeName+" WHERE key = ? LIMIT 1",[f],function(e,a){var c=a.rows.length?a.rows.item(0).value:null;c&&(c=b.serializer.deserialize(c)),g(c)},function(d,a){c(a)})})}).catch(c)});return C(b,e),b},setItem:function(d,a,b){return B.apply(this,[d,a,b,1])},removeItem:function(f,e){var h=this;f=g(f);var b=new N(function(a,c){h.ready().then(function(){var b=h._dbInfo;b.db.transaction(function(d){A(d,b,"DELETE FROM "+b.storeName+" WHERE key = ?",[f],function(){a()},function(d,a){c(a)})})}).catch(c)});return C(b,e),b},clear:function(d){var e=this,a=new N(function(b,d){e.ready().then(function(){var a=e._dbInfo;a.db.transaction(function(c){A(c,a,"DELETE FROM "+a.storeName,[],function(){b()},function(c,a){d(a)})})}).catch(d)});return C(a,d),a},length:function(d){var e=this,a=new N(function(f,d){e.ready().then(function(){var a=e._dbInfo;a.db.transaction(function(c){A(c,a,"SELECT COUNT(key) as c FROM "+a.storeName,[],function(a,b){var c=b.rows.item(0).c;f(c)},function(c,a){d(a)})})}).catch(d)});return C(a,d),a},key:function(f,a){var g=this,b=new N(function(e,c){g.ready().then(function(){var a=g._dbInfo;a.db.transaction(function(b){A(b,a,"SELECT key FROM "+a.storeName+" WHERE id = ? LIMIT 1",[f+1],function(b,a){var c=a.rows.length?a.rows.item(0).key:null;e(c)},function(d,a){c(a)})})}).catch(c)});return C(b,a),b},keys:function(d){var e=this,a=new N(function(f,d){e.ready().then(function(){var a=e._dbInfo;a.db.transaction(function(c){A(c,a,"SELECT key FROM "+a.storeName,[],function(a,b){for(var c=[],d=0;d<b.rows.length;d++)c.push(b.rows.item(d).key);f(c)},function(c,a){d(a)})})}).catch(d)});return C(a,d),a},dropInstance:function(f,g){g=h.apply(this,arguments);var i=this.config();f="function"!=typeof f&&f||{},f.name||(f.name=f.name||i.name,f.storeName=f.storeName||i.storeName);var c,j=this;return c=f.name?new N(function(a){var b;b=f.name===i.name?j._dbInfo.db:openDatabase(f.name,"","",0),a(f.storeName?{db:b,storeNames:[f.storeName]}:E(b))}).then(function(d){return new N(function(a,b){d.db.transaction(function(i){function c(d){return new N(function(a,e){i.executeSql("DROP TABLE IF EXISTS "+d,[],function(){a()},function(c,a){e(a)})})}for(var e=[],f=0,j=d.storeNames.length;f<j;f++)e.push(c(d.storeNames[f]));N.all(e).then(function(){a()}).catch(function(c){b(c)})},function(c){b(c)})})}):N.reject("Invalid arguments"),C(c,g),c}},ma={_driver:"localStorageWrapper",_initStorage:function(e){var a=this,b={};if(e)for(var c in e)b[c]=e[c];return b.keyPrefix=G(e,a._defaultConfig),I()?(a._dbInfo=b,b.serializer=ka,N.resolve()):N.reject()},_support:F(),iterate:function(f,a){var k=this,b=k.ready().then(function(){for(var a,c=k._dbInfo,b=c.keyPrefix,d=b.length,e=localStorage.length,l=1,m=0;m<e;m++)if(a=localStorage.key(m),0===a.indexOf(b)){var n=localStorage.getItem(a);if(n&&(n=c.serializer.deserialize(n)),void 0!==(n=f(n,a.substring(d),l++)))return n}});return C(b,a),b},getItem:function(e,f){var h=this;e=g(e);var b=h.ready().then(function(){var a=h._dbInfo,b=localStorage.getItem(a.keyPrefix+e);return b&&(b=a.serializer.deserialize(b)),b});return C(b,f),b},setItem:function(f,h,i){var j=this;f=g(f);var c=j.ready().then(function(){void 0===h&&(h=null);var a=h;return new N(function(c,e){var d=j._dbInfo;d.serializer.serialize(h,function(g,b){if(b)e(b);else try{localStorage.setItem(d.keyPrefix+f,g),c(a)}catch(b){"QuotaExceededError"!==b.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==b.name||e(b),e(b)}})})});return C(c,i),c},removeItem:function(e,f){var h=this;e=g(e);var b=h.ready().then(function(){var a=h._dbInfo;localStorage.removeItem(a.keyPrefix+e)});return C(b,f),b},clear:function(d){var e=this,a=e.ready().then(function(){for(var b,f=e._dbInfo.keyPrefix,a=localStorage.length-1;0<=a;a--)b=localStorage.key(a),0===b.indexOf(f)&&localStorage.removeItem(b)});return C(a,d),a},length:function(d){var a=this,b=a.keys().then(function(b){return b.length});return C(b,d),b},key:function(e,a){var f=this,b=f.ready().then(function(){var c,a=f._dbInfo;try{c=localStorage.key(e)}catch(b){c=null}return c&&(c=c.substring(a.keyPrefix.length)),c});return C(b,a),b},keys:function(d){var g=this,a=g.ready().then(function(){for(var b,h=g._dbInfo,a=localStorage.length,c=[],d=0;d<a;d++)b=localStorage.key(d),0===b.indexOf(h.keyPrefix)&&c.push(b.substring(h.keyPrefix.length));return c});return C(a,d),a},dropInstance:function(f,g){if(g=h.apply(this,arguments),f="function"!=typeof f&&f||{},!f.name){var i=this.config();f.name=f.name||i.name,f.storeName=f.storeName||i.storeName}var c,j=this;return c=f.name?new N(function(a){a(f.storeName?G(f,j._defaultConfig):f.name+"/")}).then(function(d){for(var a,e=localStorage.length-1;0<=e;e--)a=localStorage.key(e),0===a.indexOf(d)&&localStorage.removeItem(a)}):N.reject("Invalid arguments"),C(c,g),c}},na=function(c,a){return c===a||"number"==typeof c&&"number"==typeof a&&isNaN(c)&&isNaN(a)},oa=function(e,a){for(var b=e.length,c=0;c<b;){if(na(e[c],a))return!0;c++}return!1},pa=Array.isArray||function(b){return"[object Array]"===Object.prototype.toString.call(b)},qa={},ra={},sa={INDEXEDDB:U,WEBSQL:la,LOCALSTORAGE:ma},ta=[sa.INDEXEDDB._driver,sa.WEBSQL._driver,sa.LOCALSTORAGE._driver],ua=["dropInstance"],va=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ua),wa={description:"",driver:ta.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},ya=function(){function d(a){for(var g in b(this,d),sa)if(sa.hasOwnProperty(g)){var c=sa[g],e=c._driver;this[g]=e,qa[e]||this.defineDriver(c)}this._defaultConfig=K({},wa),this._config=K({},this._defaultConfig,a),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return d.prototype.config=function(c){if("object"===(void 0===c?"undefined":L(c))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var a in c){if("storeName"==a&&(c[a]=c[a].replace(/\W/g,"_")),"version"==a&&"number"!=typeof c[a])return new Error("Database version must be a number.");this._config[a]=c[a]}return!("driver"in c&&c.driver)||this.setDriver(this._config.driver)}return"string"==typeof c?this._config[c]:this._config},d.prototype.defineDriver=function(h,a,b){var c=new N(function(a,b){try{var l=h._driver,c=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!h._driver)return void b(c);for(var d,e=va.concat("_initStorage"),f=0,m=e.length;f<m;f++)if(d=e[f],(!oa(ua,d)||h[d])&&"function"!=typeof h[d])return void b(c);(function(){for(var a,f=function(d){return function(){var a=new Error("Method "+d+" is not implemented by the current driver"),b=N.reject(a);return C(b,arguments[arguments.length-1]),b}},b=0,g=ua.length;b<g;b++)a=ua[b],h[a]||(h[a]=f(a))})();var i=function(b){qa[l]&&console.info("Redefining LocalForage driver: "+l),qa[l]=h,ra[l]=b,a()};"_support"in h?h._support&&"function"==typeof h._support?h._support().then(i,b):i(!!h._support):i(!0)}catch(c){b(c)}});return D(c,a,b),c},d.prototype.driver=function(){return this._driver||null},d.prototype.getDriver=function(e,a,b){var c=qa[e]?N.resolve(qa[e]):N.reject(new Error("Driver not found."));return D(c,a,b),c},d.prototype.getSerializer=function(c){var a=N.resolve(ka);return D(a,c),a},d.prototype.ready=function(d){var a=this,b=a._driverSet.then(function(){return null===a._ready&&(a._ready=a._initDriver()),a._ready});return D(b,d,d),b},d.prototype.setDriver=function(i,k,b){function l(){e._config.driver=e.driver()}function d(b){return e._extend(b),l(),e._ready=e._initStorage(e._config),e._ready}function c(g){return function(){function a(){for(;b<g.length;){var c=g[b];return b++,e._dbInfo=null,e._ready=null,e.getDriver(c).then(d).catch(a)}l();var f=new Error("No available storage method found.");return e._driverSet=N.reject(f),e._driverSet}var b=0;return a()}}var e=this;pa(i)||(i=[i]);var f=this._getSupportedDrivers(i),g=null===this._driverSet?N.resolve():this._driverSet.catch(function(){return N.resolve()});return this._driverSet=g.then(function(){var b=f[0];return e._dbInfo=null,e._ready=null,e.getDriver(b).then(function(b){e._driver=b._driver,l(),e._wrapLibraryMethodsWithReady(),e._initDriver=c(f)})}).catch(function(){l();var b=new Error("No available storage method found.");return e._driverSet=N.reject(b),e._driverSet}),D(this._driverSet,k,b),this._driverSet},d.prototype.supports=function(b){return!!ra[b]},d.prototype._extend=function(b){K(this,b)},d.prototype._getSupportedDrivers=function(f){for(var a,g=[],b=0,h=f.length;b<h;b++)a=f[b],this.supports(a)&&g.push(a);return g},d.prototype._wrapLibraryMethodsWithReady=function(){for(var c=0,d=va.length;c<d;c++)J(this,va[c])},d.prototype.createInstance=function(a){return new d(a)},d}(),za=new ya;a.exports=za},{3:3}]},{},[4])(4)});var map,EmptyStorageError=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Error),DBHelper=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"fetchNewData",value:function(){return fetch(a.DATABASE_URL).then(function(a){return a.json()})}},{key:"putData",value:function(a){return localforage.clear().then(function(){var b=a.map(function(a){return localforage.setItem(a.id,a)});return Promise.all(b)})}},{key:"isEmpty",value:function(){return localforage.length().then(function(a){return 0===a})}},{key:"updateData",value:function(){return fetch(a.DATABASE_URL).then(function(a){return a.json()}).then(function(a){return localforage.clear().then(function(){return a})}).then(function(a){var b=a.map(function(a){return localforage.setItem(a.id,a)});return Promise.all(b)})}},{key:"fetchRestaurants",value:function(){return localforage.keys().then(function(a){if(0===a.length)throw new EmptyStorageError;var b=a.map(function(a){return localforage.getItem(a)});return Promise.all(b)})}},{key:"fetchRestaurantById",value:function(a){return localforage.getItem(a)}},{key:"fetchRestaurantByCuisine",value:function(b){return a.fetchRestaurants().then(function(){return restaurants.filter(function(a){return a.cuisine_type==b})})}},{key:"fetchRestaurantByNeighborhood",value:function(b){return a.fetchRestaurants().then(function(){return restaurants.filter(function(a){return a.neighborhood==b})})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(b,c){return a.fetchRestaurants().then(function(a){return"all"==b?"all"==c?a:a.filter(function(a){return a.neighborhood==c}):a.filter(function(a){return a.cuisine_type==b})})}},{key:"fetchNeighborhoods",value:function(){return a.fetchRestaurants().then(function(a){return a.map(function(b,c){return a[c].neighborhood}).filter(function(a,b,c){return c.indexOf(a)==b})})}},{key:"fetchCuisines",value:function(){return a.fetchRestaurants().then(function(a){return a.map(function(b,c){return a[c].cuisine_type}).filter(function(a,b,c){return c.indexOf(a)==b})})}},{key:"urlForRestaurant",value:function(a){return"./restaurant.html?id="+a.id}},{key:"imageUrlForRestaurant",value:function(a){return"/img/"+a.photograph}},{key:"mapMarkerForRestaurant",value:function(b,c){var d=new google.maps.Marker({position:b.latlng,title:b.name,url:a.urlForRestaurant(b),map:c,animation:google.maps.Animation.DROP});return d}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337/restaurants"}}]),a}(),restaurant=void 0;window.initMap=function(){registerServiceWorker(),fetchRestaurantFromURL().then(function(a){self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:a.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map)}).catch(console.error)};var registerServiceWorker=function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"./"})},fetchRestaurantFromURL=function(){if(self.restaurant)return Promise.resolve(self.restaurant);var a=getParameterByName("id");return a?DBHelper.fetchRestaurantById(a).then(function(a){return self.restaurant=a,fillRestaurantHTML(),a}):Promise.reject("No restaurant id in URL")},fillRestaurantHTML=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:self.restaurant,b=document.getElementById("restaurant-name");b.innerHTML=a.name;var c=document.getElementById("restaurant-address");c.innerHTML=a.address;var d=document.getElementById("restaurant-img");d.className="restaurant-img",d.alt="Photo of the "+a.name+" restaurant";var e=DBHelper.imageUrlForRestaurant(a);d.src=e+"-480.jpg",d.srcset=e+"-480.jpg 1x, "+e+"-800.jpg 2x";var f=document.getElementById("restaurant-cuisine");f.innerHTML=a.cuisine_type,a.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:self.restaurant.operating_hours,b=document.getElementById("restaurant-hours"),c=b.querySelector("tbody");for(var d in a){var e=document.createElement("tr"),f=document.createElement("th");f.classList.add("left"),f.innerHTML=d,e.appendChild(f);var g=document.createElement("td");g.classList.add("right");var h=document.createElement("span");h.innerHTML=a[d],g.appendChild(h),e.appendChild(g),c.appendChild(e)}},fillReviewsHTML=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:self.restaurant.reviews,b=document.getElementById("reviews-container");if(!a){var c=document.createElement("p");return c.innerHTML="No reviews yet!",void b.appendChild(c)}var d=document.getElementById("reviews-list");a.forEach(function(a){d.appendChild(createReviewHTML(a))}),b.appendChild(d)},createReviewHTML=function(a){var b=document.createElement("li");b.classList.add("card");var c=document.createElement("span");c.classList.add("username"),c.innerHTML=a.name,b.appendChild(c);var d=document.createElement("span");d.classList.add("date"),d.innerHTML=a.date,b.appendChild(d);var e=document.createElement("p");e.classList.add("rating"),e.innerHTML="\u2605".repeat(a.rating),b.appendChild(e);var f=document.createElement("p");return f.classList.add("comments"),f.innerHTML=a.comments,b.appendChild(f),b},fillBreadcrumb=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:self.restaurant,b=document.getElementById("breadcrumb"),c=document.createElement("li");c.innerHTML=a.name,c.setAttribute("aria-current","page"),b.appendChild(c)},getParameterByName=function(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null};